<%@page import="java.io.InputStream"%>
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<%@ page import="java.sql.*" %>

<%
	Integer id =(Integer)session.getAttribute("uid");
    InputStream image = request.getPart("image").getInputStream();
    String company = request.getParameter("company");
    String github = request.getParameter("github");
    String linkedin = request.getParameter("linkedin");
    String nationality = request.getParameter("nationality");
    String gender = request.getParameter("gender");
    String website = request.getParameter("website");

    Connection connection = null;
    PreparedStatement statement = null;

    try {
        Class.forName("com.mysql.cj.jdbc.Driver");
        connection = DriverManager.getConnection("jdbc:mysql://localhost:3306/sdCommunity","root", "Love1999@MySQL");

        String sql = "INSERT INTO user_info (image, company, github, linkedin, nationality, gender, website, uid) VALUES (?, ?, ?, ?, ?, ?, ?, ?)";
        statement = connection.prepareStatement(sql);

        // Set the parameters
        statement.setBlob(1, image);
        statement.setString(2, company);
        statement.setString(3, github);
        statement.setString(4, linkedin);
        statement.setString(5, nationality);
        statement.setString(6, gender);
        statement.setString(7, website);
        statement.setInt(8,id);

        statement.executeUpdate();

        // Redirect to a success page if needed
        response.sendRedirect("../Login/Login.jsp");
    } catch (Exception e) {
        e.printStackTrace();
    } finally {
        try {
            if (statement != null) statement.close();
            if (connection != null) connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
%>